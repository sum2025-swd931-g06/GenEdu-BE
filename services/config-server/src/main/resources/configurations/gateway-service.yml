server:
  port: ${GATEWAY_SERVICE_PORT:8222}
spring:
  security:
    oauth2:
      resourceserver:
        jwt:
          issuer-uri: ${JWT_ISSUER_URI:http://localhost:9099/realms/GenEdu}
          jwk-set-uri: ${JWT_SET_JWKS_URI:http://localhost:9099/realms/GenEdu/protocol/openid-connect/certs}
  # Gateway configuration
  cloud:
    gateway:
      discovery:
        locator:
          enabled: true
      globalcors:
        cors-configurations:
          '[/**]':
            allowedOrigins: '*'
            allowedMethods: '*'
            allowedHeaders: '*'
            allowCredentials: false
  # Route configuration
      routes:
        # User Service Routes
        - id: user-service
          uri: lb://USER-SERVICE
          predicates:
            - Path=/api/v1/users/**
        # User Service Swagger Route
        - id: user-service-swagger
          uri: lb://USER-SERVICE
          predicates:
            - Path=/aggregate/user-service/**
          filters:
            - RewritePath=/aggregate/user-service(?<segment>/?.*), $\{segment}
        # Content Service Routes
        - id: content-service
          uri: lb://CONTENT-SERVICE
          predicates:
            - Path=/api/v1/contents/**
        # Content Service Swagger Route
        - id: content-service-swagger
          uri: lb://CONTENT-SERVICE
          predicates:
            - Path=/aggregate/content-service/**
          filters:
            - RewritePath=/aggregate/content-service(?<segment>/?.*), $\{segment}
        # Project Service Routes
        - id: project-service
          uri: lb://PROJECT-SERVICE
          predicates:
            - Path=/api/v1/projects/**
        # Project Service Swagger Route
        - id: project-service-swagger
          uri: lb://PROJECT-SERVICE
          predicates:
            - Path=/aggregate/project-service/**
          filters:
            - RewritePath=/aggregate/project-service(?<segment>/?.*), $\{segment}
        # Project Service Routes
        - id: media-service
          uri: lb://MEDIA-SERVICE
          predicates:
            - Path=/api/v1/media/**
        # Project Service Swagger Route
        - id: media-service-swagger
          uri: lb://MEDIA-SERVICE
          predicates:
            - Path=/aggregate/media-service/**
          filters:
            - RewritePath=/aggregate/media-service(?<segment>/?.*), $\{segment}


# Spring Doc configuration
springdoc:
  api-docs:
    path: /v3/api-docs
  swagger-ui:
    path: /swagger-ui.html
    use-root-path: true
    # Configuration for Swagger UI Services
    urls:
      - name: User Service
        url: /aggregate/user-service/v3/api-docs
      - name: Content Service
        url: /aggregate/content-service/v3/api-docs
      - name: Project Service
        url: /aggregate/project-service/v3/api-docs
      - name: Media Service
        url: /aggregate/media-service/v3/api-docs
    oauth:
      client-id: ${KC_GENEDU_GENEDU_BE_CLIENT_ID:genedu-be}
      client-secret: ${KC_GENEDU_GENEDU_BE_GENEDU_SCRET_KEY:0pQYYepE82DkALnEVhAfZREPeHmtHz3z}
    csrf:
      enabled: false